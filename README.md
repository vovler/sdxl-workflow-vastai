


watch -n 0.1 nvidia-smi ## create an alias for this

HOSTNAME ENV?
VAST_TCP_PORT_80
find equivalent for "new_contract" value
CONTAINER_ID=22352052 (?)

trt.init_libnvinfer_plugins(None, "")
https://huggingface.co/SmilingWolf/wd-vit-tagger-v3

optimum-cli export onnx --device cuda --opset 18 --dtype fp16 --slim --model socks22/sdxl-wai-nsfw-illustriousv14 --task text-to-image wai_dmd2_onnx

cqyan/hybrid-sd-tinyvae-xl

pip install onnxslim
onnxslim --inspect model.onnx

############## PIP ###############3
TMPDIR=/dev/shm/ pip install --no-cache-dir -r requirements.txt && rm -rf /dev/shm/*

apt update -y; apt upgrade -y;
pip install --upgrade pip;
apt install aria2;
aria2c -x 16 -s 16 -k 10M "https://test-storage-pull1123.b-cdn.net/diffusion_pytorch_model.safetensors"


sudo apt install libjemalloc-dev libjemalloc2
export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libjemalloc.so.2:$LD_PRELOAD
export PYTORCH_CUDA_ALLOC_CONF='expandable_segments:True'
python your_training_script.py

############## VLLM ###############

pip install vllm flashinfer-python

python -m vllm.entrypoints.openai.api_server \
    --model Qwen/Qwen3-8B-AWQ \
    --quantization awq_marlin \
    --trust-remote-code \
    --max-model-len 8192 \
    --gpu-memory-utilization 0.5 \
    --host 127.0.0.1 \
    --port 80
	


############## VAST AI ##############
vastai change bid

show instance
execute
show instances

vastai search offers --interruptible --storage=10 'reliability > 0.98 num_gpus=1 gpu_name=RTX_3060 rented=False' -o "min_bid+"



vastai create instance 19958699 --bid_price 0.039 --image vastai/pytorch:2.6.0-cuda-12.4.1-py312-22.04 --env '-p 1111:1111 -p 6006:6006 -p 8080:8080 -p 8384:8384 -p 72299:72299 -p 80:80 -e OPEN_BUTTON_PORT=1111 -e OPEN_BUTTON_TOKEN=1 -e JUPYTER_DIR=/ -e DATA_DIRECTORY=/workspace/ -e PORTAL_CONFIG="localhost:1111:11111:/:Instance Portal|localhost:8080:18080:/:Jupyter|localhost:8080:8080:/terminals/1:Jupyter Terminal|localhost:8384:18384:/:Syncthing|localhost:6006:16006:/:Tensorboard" -e WORKFLOW_GIT_URL=https://github.com/vovler/vastai-sdxl-workflow -e PARENT_HOST=168.119.117.45 -e PROVISIONING_SCRIPT=https://raw.githubusercontent.com/vovler/vastai-sdxl-provisioning/refs/heads/main/provisioning.sh' --onstart-cmd 'entrypoint.sh' --disk 10 --jupyter --ssh --direct
{'success': True, 'new_contract': 21963913}

vastai show instance 21964380

vastai change bid 21964380 --price='0.01'
